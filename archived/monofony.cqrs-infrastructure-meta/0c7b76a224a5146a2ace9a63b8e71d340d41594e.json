{
    "manifests": {
        "monofony/cqrs-infrastructure-meta": {
            "manifest": {
                "copy-from-recipe": {
                    "config/": "%CONFIG_DIR%/",
                    "src/": "%SRC_DIR%/"
                }
            },
            "files": {
                "config/packages/monofony_cqrs.yaml": {
                    "contents": [
                        "framework:",
                        "    messenger:",
                        "        default_bus: 'command.bus'",
                        "        buses:",
                        "            command.bus: null",
                        "            query.bus: null",
                        ""
                    ],
                    "executable": false
                },
                "src/Shared/Infrastructure/Symfony/Messenger/MessengerCommandBus.php": {
                    "contents": [
                        "<?php",
                        "",
                        "declare(strict_types=1);",
                        "",
                        "namespace App\\Shared\\Infrastructure\\Symfony\\Messenger;",
                        "",
                        "use App\\Shared\\Application\\Command\\CommandBusInterface;",
                        "use App\\Shared\\Application\\Command\\CommandInterface;",
                        "use Symfony\\Component\\Messenger\\Exception\\HandlerFailedException;",
                        "use Symfony\\Component\\Messenger\\HandleTrait;",
                        "use Symfony\\Component\\Messenger\\MessageBusInterface;",
                        "",
                        "final class MessengerCommandBus implements CommandBusInterface",
                        "{",
                        "    use HandleTrait;",
                        "",
                        "    public function __construct(MessageBusInterface $commandBus)",
                        "    {",
                        "        $this->messageBus = $commandBus;",
                        "    }",
                        "",
                        "    public function dispatch(CommandInterface $command): mixed",
                        "    {",
                        "        try {",
                        "            return $this->handle($command);",
                        "        } catch (HandlerFailedException $e) {",
                        "            /** @var array{0: \\Throwable} $exceptions */",
                        "            $exceptions = $e->getWrappedExceptions();",
                        "",
                        "            throw reset($exceptions);",
                        "        }",
                        "    }",
                        "}",
                        ""
                    ],
                    "executable": false
                },
                "src/Shared/Infrastructure/Symfony/Messenger/MessengerQueryBus.php": {
                    "contents": [
                        "<?php",
                        "",
                        "declare(strict_types=1);",
                        "",
                        "namespace App\\Shared\\Infrastructure\\Symfony\\Messenger;",
                        "",
                        "use App\\Shared\\Application\\Query\\QueryBusInterface;",
                        "use App\\Shared\\Application\\Query\\QueryInterface;",
                        "use Symfony\\Component\\Messenger\\Exception\\HandlerFailedException;",
                        "use Symfony\\Component\\Messenger\\HandleTrait;",
                        "use Symfony\\Component\\Messenger\\MessageBusInterface;",
                        "",
                        "final class MessengerQueryBus implements QueryBusInterface",
                        "{",
                        "    use HandleTrait;",
                        "",
                        "    public function __construct(MessageBusInterface $queryBus)",
                        "    {",
                        "        $this->messageBus = $queryBus;",
                        "    }",
                        "",
                        "    public function ask(QueryInterface $query): mixed",
                        "    {",
                        "        try {",
                        "            return $this->handle($query);",
                        "        } catch (HandlerFailedException $e) {",
                        "            /** @var array{0: \\Throwable} $exceptions */",
                        "            $exceptions = $e->getWrappedExceptions();",
                        "",
                        "            throw reset($exceptions);",
                        "        }",
                        "    }",
                        "}",
                        ""
                    ],
                    "executable": false
                }
            },
            "ref": "0c7b76a224a5146a2ace9a63b8e71d340d41594e"
        }
    }
}
